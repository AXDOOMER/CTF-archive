# malware_module (150 pts)

Des chercheurs ont découvert qu'un certain maliciel téléchargeait un module externe permettant d'enregistrer les actions d'un curseur à l'écran. Ils ont réussi à récupérer le fichier téléchargé, cependant c'est une image et ne savent pas où se cache le module. Pouvez-vous les aider à trouver le module et à découvrir son fonctionnement?

Researchers have discovered that some malware is downloading an external module used to record the actions of a mouse cursor on the screen. They managed to recover the downloaded file, however it's a picture and there's no sign of a module. Can you help them recover the module and discover how it works?

Le flag suit le format flag{ }.

# Solution

Sur le bit moins significatif de chaque canal de couleur de chaque pixel, il y a un PE d'encodé (Un fichier executable Windows débutant par "MZ"). On peut le déduire en examinant les pixels blancs. Sinon, l'utilisation de StegSolve simplifie grandement le challenge. Une fois le PE extrait, on peut l'exécuter. Il s'agit d'un logiciel qui capture les mouvements de notre souris. Après plusieurs mouvements et cinq clics, il montre le flag. 

Sinon, on peut unpacker l'exécutable qui est compressée avec UPX. Ceci permet de voir le flag avec un hex editor (ou la commande `strings` sur Linux)

flag{STEHG-uh-NAH-gruhf-ee}

Ce challenge a été réussi par 6 personnes.
