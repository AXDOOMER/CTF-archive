# https://wiki.python.org/moin/BitManipulation
# https://stackoverflow.com/questions/48684885/c-sharp-changing-least-significant-bit-image-algorithm


#pic = (open("theencodedimage.data", "r+b")).read()
pic = (open("picture.data", "r+b")).read()
#imgdata.data
#pic = (open("egg.data", "r+b")).read()

#print(len(exe))
print(len(pic))

# exe: 01001101 01011010 10010000 00000000

exepos = 0
data = "";

#for pos in range(len(pic) * 8):
for pos in range(len(pic) * 8):

	if pos % 8 == 7:
		# Bit order is reversed, (7-pos) will reverse them
		boolean = ord(pic[pos / 8]) & (1 << (7-pos) % 8) != 0
		data += str(int(boolean))

		#print(data)


#print(data)
print(len(data))

with open("new.exe", 'wa') as out:
	for pos in range(len(data)):
		na = data[pos*8 : pos*8+8]
		sa = ''.join(na)
#		print(sa)
		ca = chr(int(sa, 2))
		out.write(ca)

